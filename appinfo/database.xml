<?xml version="1.0" ?>
<database>
	<name>*dbname*</name>
	<create>true</create>
	<overwrite>false</overwrite>
	<charset>utf8</charset>

	<table>
		<name>*dbprefix*music_artists</name>
		<declaration>
			<field>
				<name>id</name>
				<type>integer</type>
				<notnull>true</notnull>
				<autoincrement>true</autoincrement>
				<unsigned>true</unsigned>
				<primary>true</primary>
			</field>
			<field>
				<name>user_id</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>64</length>
			</field>
			<field>
				<name>name</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>256</length>
			</field>
			<field>
				<name>cover_file_id</name>
				<type>integer</type>
				<notnull>false</notnull>
				<length>10</length>
			</field>
			<field>
				<name>mbid</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>36</length>
			</field>
			<field>
				<name>hash</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>32</length>
				<comments>Unique hash formed from the artist name. The name field as such is too long to be indexed.</comments>
			</field>
			<field>
				<name>starred</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>created</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>updated</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>

			<index>
				<name>user_id_hash_idx</name>
				<unique>true</unique>
				<field>
					<name>user_id</name>
				</field>
				<field>
					<name>hash</name>
				</field>
			</index>
		</declaration>
	</table>

	<table>
		<name>*dbprefix*music_albums</name>
		<declaration>
			<field>
				<name>id</name>
				<type>integer</type>
				<notnull>true</notnull>
				<autoincrement>true</autoincrement>
				<unsigned>true</unsigned>
				<primary>true</primary>
			</field>
			<field>
				<name>user_id</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>64</length>
			</field>
			<field>
				<name>name</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>256</length>
			</field>
			<field>
				<name>cover_file_id</name>
				<type>integer</type>
				<notnull>false</notnull>
				<length>10</length>
			</field>
			<field>
				<name>mbid</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>36</length>
			</field>
			<field>
				<name>disk</name>
				<type>integer</type>
				<notnull>false</notnull>
				<unsigned>true</unsigned>
				<comments>deprecated</comments>
			</field>
			<field>
				<name>mbid_group</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>36</length>
			</field>
			<field>
				<name>album_artist_id</name>
				<type>integer</type>
				<notnull>false</notnull>
				<unsigned>true</unsigned>
			</field>
			<field>
				<name>hash</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>32</length>
				<comments>Unique hash formed from the fields composing the identity of the album</comments>
			</field>
			<field>
				<name>starred</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>created</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>updated</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>

			<index>
				<name>ma_cover_file_id_idx</name>
				<field>
					<name>cover_file_id</name>
				</field>
			</index>
			<index>
				<name>ma_album_artist_id_idx</name>
				<field>
					<name>album_artist_id</name>
				</field>
			</index>
			<index>
				<name>ma_user_id_hash_idx</name>
				<unique>true</unique>
				<field>
					<name>user_id</name>
				</field>
				<field>
					<name>hash</name>
				</field>
			</index>
		</declaration>
	</table>

	<table>
		<name>*dbprefix*music_tracks</name>
		<declaration>
			<field>
				<name>id</name>
				<type>integer</type>
				<notnull>true</notnull>
				<autoincrement>true</autoincrement>
				<unsigned>true</unsigned>
				<primary>true</primary>
			</field>
			<field>
				<name>user_id</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>64</length>
			</field>
			<field>
				<name>title</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>256</length>
			</field>
			<field>
				<name>number</name>
				<type>integer</type>
				<notnull>false</notnull>
				<unsigned>true</unsigned>
			</field>
			<field>
				<name>disk</name>
				<type>integer</type>
				<notnull>false</notnull>
				<unsigned>true</unsigned>
			</field>
			<field>
				<name>year</name>
				<type>integer</type>
				<notnull>false</notnull>
				<unsigned>false</unsigned>
			</field>
			<field>
				<name>artist_id</name>
				<type>integer</type>
				<notnull>false</notnull>
				<unsigned>true</unsigned>
			</field>
			<field>
				<name>album_id</name>
				<type>integer</type>
				<notnull>false</notnull>
				<unsigned>true</unsigned>
			</field>
			<field>
				<name>length</name>
				<type>integer</type>
				<notnull>false</notnull>
				<unsigned>true</unsigned>
			</field>
			<field>
				<name>file_id</name>
				<type>integer</type>
				<notnull>true</notnull>
				<length>10</length>
			</field>
			<field>
				<name>bitrate</name>
				<type>integer</type>
				<notnull>false</notnull>
				<unsigned>true</unsigned>
			</field>
			<field>
				<name>mimetype</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>256</length>
			</field>
			<field>
				<name>mbid</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>36</length>
			</field>
			<field>
				<name>starred</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>genre_id</name>
				<type>integer</type>
				<notnull>false</notnull>
				<unsigned>true</unsigned>
			</field>
			<field>
				<name>play_count</name>
				<type>integer</type>
				<notnull>true</notnull>
				<unsigned>true</unsigned>
				<default>0</default>
			</field>
			<field>
				<name>last_played</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>created</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>updated</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>

			<index>
				<name>music_tracks_artist_id_idx</name>
				<field>
					<name>artist_id</name>
				</field>
			</index>
			<index>
				<name>music_tracks_album_id_idx</name>
				<field>
					<name>album_id</name>
				</field>
			</index>
			<index>
				<name>music_tracks_user_id_idx</name>
				<field>
					<name>user_id</name>
				</field>
			</index>
			<index>
				<name>music_tracks_file_user_id_idx</name>
				<unique>true</unique>
				<field>
					<name>file_id</name>
				</field>
				<field>
					<name>user_id</name>
				</field>
			</index>
		</declaration>
	</table>

	<table>
		<name>*dbprefix*music_playlists</name>
		<declaration>
			<field>
				<name>id</name>
				<type>integer</type>
				<notnull>true</notnull>
				<autoincrement>true</autoincrement>
				<unsigned>true</unsigned>
				<primary>true</primary>
			</field>
			<field>
				<name>user_id</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>64</length>
			</field>
			<field>
				<name>name</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>256</length>
			</field>
			<field>
				<name>track_ids</name>
				<type>clob</type>
				<notnull>false</notnull>
				<comments>|-delimited list of track IDs</comments>
			</field>
			<field>
				<name>created</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>updated</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>comment</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>256</length>
			</field>
		</declaration>
	</table>

	<table>
		<name>*dbprefix*music_genres</name>
		<declaration>
			<field>
				<name>id</name>
				<type>integer</type>
				<notnull>true</notnull>
				<autoincrement>true</autoincrement>
				<unsigned>true</unsigned>
				<primary>true</primary>
			</field>
			<field>
				<name>user_id</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>64</length>
			</field>
			<field>
				<name>name</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>64</length>
			</field>
			<field>
				<name>lower_name</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>64</length>
				<comments>Used to enforce uniquenes of genres in case insensitive sense</comments>
			</field>
			<field>
				<name>created</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>updated</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>

			<index>
				<name>mg_lower_name_user_id_idx</name>
				<unique>true</unique>
				<field>
					<name>lower_name</name>
				</field>
				<field>
					<name>user_id</name>
				</field>
			</index>
		</declaration>
	</table>

	<table>
		<name>*dbprefix*music_radio_stations</name>
		<declaration>
			<field>
				<name>id</name>
				<type>integer</type>
				<notnull>true</notnull>
				<autoincrement>true</autoincrement>
				<unsigned>true</unsigned>
				<primary>true</primary>
			</field>
			<field>
				<name>user_id</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>64</length>
			</field>
			<field>
				<name>name</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>256</length>
			</field>
			<field>
				<name>stream_url</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>2048</length>
			</field>
			<field>
				<name>home_url</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>2048</length>
			</field>
			<field>
				<name>created</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>updated</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
		</declaration>
	</table>

	<table>
		<name>*dbprefix*music_podcast_channels</name>
		<declaration>
			<field>
				<name>id</name>
				<type>integer</type>
				<notnull>true</notnull>
				<autoincrement>true</autoincrement>
				<unsigned>true</unsigned>
				<primary>true</primary>
			</field>
			<field>
				<name>user_id</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>64</length>
			</field>
			<field>
				<name>rss_url</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>2048</length>
			</field>
			<field>
				<name>rss_hash</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>64</length>
			</field>
			<field>
				<name>content_hash</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>64</length>
			</field>
			<field>
				<name>update_checked</name>
				<type>timestamp</type>
				<notnull>true</notnull>
			</field>
			<field>
				<name>published</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>last_build_date</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>title</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>256</length>
			</field>
			<field>
				<name>link_url</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>2048</length>
			</field>
			<field>
				<name>language</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>32</length>
			</field>
			<field>
				<name>copyright</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>256</length>
			</field>
			<field>
				<name>author</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>256</length>
			</field
>			<field>
				<name>description</name>
				<type>clob</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>image_url</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>2048</length>
			</field>
			<field>
				<name>category</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>256</length>
			</field>
			<field>
				<name>starred</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>created</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>updated</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>

			<index>
				<name>music_podcast_channels_index</name>
				<unique>true</unique>
				<field>
					<name>rss_hash</name>
				</field>
				<field>
					<name>user_id</name>
				</field>
			</index>
		</declaration>
	</table>

	<table>
		<name>*dbprefix*music_podcast_episodes</name>
		<declaration>
			<field>
				<name>id</name>
				<type>integer</type>
				<notnull>true</notnull>
				<autoincrement>true</autoincrement>
				<unsigned>true</unsigned>
				<primary>true</primary>
			</field>
			<field>
				<name>user_id</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>64</length>
			</field>
			<field>
			<name>channel_id</name>
				<type>integer</type>
				<notnull>true</notnull>
				<unsigned>true</unsigned>
			</field>
			<field>
				<name>stream_url</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>2048</length>
			</field>
			<field>
				<name>mimetype</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>256</length>
			</field>
			<field>
				<name>size</name>
				<type>integer</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>duration</name>
				<type>integer</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>guid</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>2048</length>
			</field>
			<field>
				<name>guid_hash</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>64</length>
			</field>
			<field>
				<name>title</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>256</length>
			</field>
			<field>
				<name>episode</name>
				<type>integer</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>season</name>
				<type>integer</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>link_url</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>2048</length>
			</field>
			<field>
				<name>published</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>keywords</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>256</length>
			</field>
			<field>
				<name>copyright</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>256</length>
			</field>
			<field>
				<name>author</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>256</length>
			</field>
			<field>
				<name>description</name>
				<type>clob</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>starred</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>created</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>updated</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>

			<index>
				<name>music_podcast_episodes_index</name>
				<unique>true</unique>
				<field>
					<name>guid_hash</name>
				</field>
				<field>
					<name>channel_id</name>
				</field>
				<field>
					<name>user_id</name>
				</field>
			</index>
		</declaration>
	</table>

	<table>
		<name>*dbprefix*music_ampache_sessions</name>
		<declaration>
			<field>
				<name>id</name>
				<type>integer</type>
				<notnull>true</notnull>
				<autoincrement>true</autoincrement>
				<unsigned>true</unsigned>
				<primary>true</primary>
			</field>
			<field>
				<name>user_id</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>64</length>
			</field>
			<field>
				<name>token</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>64</length>
			</field>
			<field>
				<name>expiry</name>
				<type>integer</type>
				<notnull>true</notnull>
				<unsigned>true</unsigned>
			</field>
			<field>
				<name>api_version</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>16</length>
			</field>

			<index>
				<name>music_ampache_sessions_index</name>
				<unique>true</unique>
				<field>
					<name>token</name>
				</field>
			</index>
		</declaration>
	</table>

	<table>
		<name>*dbprefix*music_ampache_users</name>
		<declaration>
			<field>
				<name>id</name>
				<type>integer</type>
				<notnull>true</notnull>
				<autoincrement>true</autoincrement>
				<unsigned>true</unsigned>
				<primary>true</primary>
			</field>
			<field>
				<name>user_id</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>64</length>
			</field>
			<field>
				<name>description</name>
				<type>text</type>
				<length>64</length>
			</field>
			<field>
				<name>hash</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>64</length>
			</field>

			<index>
				<name>music_ampache_users_index</name>
				<unique>true</unique>
				<field>
					<name>hash</name>
				</field>
				<field>
					<name>user_id</name>
				</field>
			</index>
		</declaration>
	</table>

	<table>
		<name>*dbprefix*music_cache</name>
		<declaration>
			<field>
				<name>id</name>
				<type>integer</type>
				<notnull>true</notnull>
				<autoincrement>true</autoincrement>
				<unsigned>true</unsigned>
				<primary>true</primary>
			</field>
			<field>
				<name>key</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>64</length>
			</field>
			<field>
				<name>user_id</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>64</length>
			</field>
			<field>
				<name>data</name>
				<type>clob</type>
				<notnull>false</notnull>
			</field>

			<index>
				<name>music_cache_index</name>
				<unique>true</unique>
				<field>
					<name>user_id</name>
				</field>
				<field>
					<name>key</name>
				</field>
			</index>
		</declaration>
	</table>

	<table>
		<name>*dbprefix*music_bookmarks</name>
		<declaration>
			<field>
				<name>id</name>
				<type>integer</type>
				<notnull>true</notnull>
				<autoincrement>true</autoincrement>
				<unsigned>true</unsigned>
				<primary>true</primary>
			</field>
			<field>
				<name>user_id</name>
				<type>text</type>
				<notnull>true</notnull>
				<length>64</length>
			</field>
			<field>
				<name>type</name>
				<type>integer</type>
				<notnull>true</notnull>
			</field>
			<field>
				<name>entry_id</name>
				<type>integer</type>
				<notnull>true</notnull>
				<unsigned>true</unsigned>
				<comments>ID of a track or a podcast episode, depending on the column 'type'</comments>
			</field>
			<field>
				<name>position</name>
				<type>integer</type>
				<notnull>true</notnull>
			</field>
			<field>
				<name>comment</name>
				<type>text</type>
				<notnull>false</notnull>
				<length>256</length>
			</field>
			<field>
				<name>created</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>
			<field>
				<name>updated</name>
				<type>timestamp</type>
				<notnull>false</notnull>
			</field>

			<index>
				<name>music_bookmarks_index</name>
				<unique>true</unique>
				<field>
					<name>user_id</name>
				</field>
				<field>
					<name>type</name>
				</field>
				<field>
					<name>entry_id</name>
				</field>
			</index>
		</declaration>
	</table>
</database>
